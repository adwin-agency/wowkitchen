<template>
  <div
    ref="article"
    class="article"
  >
    <div class="article__intro">
      <picture class="article__intro-picture">
        <source
          srcset="@/assets/img/articles/banner_1920.jpg"
          media="(min-width: 1290px)"
          type="image/png"
        >
        <source
          srcset="@/assets/img/articles/banner_1280.jpg"
          media="(min-width: 960px)"
          type="image/png"
        >
        <source
          srcset="@/assets/img/articles/banner_960.jpg"
          media="(min-width: 0px)"
          type="image/png"
        >
        <img
          class="article__intro-img"
          src="@/assets/img/articles/banner_1920.jpg"
          alt="intro-banner"
        >
      </picture>
      <div class="container">
        <h1 class="article__intro-title">Зеленый свет вашей кухне!</h1>
      </div>
    </div>
    <div class="article__container">
      <div class="container">
        <div class="article__inner">
          <div class="article__section-container">
            <article class="article__section">

              <h2>Зеленый свет вашей кухне!</h2>
              <p>
                Кухня в зеленых тонах — отличный выбор для людей, которые в цветовых решениях ищут компромисс между спокойными оттенками и сочными акцентами.
                На такой кухне можно в субботу шумно отпраздновать День Святого Патрика, а в воскресенье устроить тихий семейный ужин - спасибо универсальности зеленого цвета!
              </p>
              <p>
                Кухонная обстановка может быть достаточно неординарной и вписаться в разные интерьеры и стили. В этой статье расскажем вам о плюсах и минусах зелёных кухонь,
                а также рассмотрим наиболее популярные оттенки этого цвета.
              </p>
              <div>
                <h4>Содержание</h4>
                <ol>
                  <li><a href="#">Преимущества этой цветовой гаммы</a></li>
                  <li><a href="#">Возможные сложности</a></li>
                  <li><a href="#">Разнообразие оттенков и как с ними совладать</a></li>
                </ol>
              </div>

              <p>
                В последнее время кухни зеленого цвета стали очень популярны. Психологи считают, что подобный цвет отлично подойдет для оформления различных
                интерьеров: зеленый цвет благоприятно влияет на эмоциональное состояние человека, помогая успокоиться и снять стресс.
              </p>

              <img
                src="@/assets/img/articles/article-img/37.jpg"
                alt="image"
              >
              <div>
                <img
                  src="@/assets/img/articles/article-img/39.png"
                  alt="image"
                >
                <img
                  src="@/assets/img/articles/article-img/38.png"
                  alt="image"
                >
              </div>

              <h3>Преимущества этой цветовой гаммы</h3>
              <ol>
                <li>
                  <b>Практичность.</b>Зеленый цвет умеет маскировать загрязнения, даже если речь идет о светлых оттенках.
                  Про ежедневную уборку можно забыть!
                </li>
                <div>
                  <h5>Почитать по теме</h5>
                  <a href="#">Глянцевые или матовые фасады: основная разница во внешнем виде и уходе</a>
                </div>
                <li>
                  50 оттенков. Как вы понимаете, не только серый может похвастаться своей <b>вариативностью</b> (спасибо одноименному фильму).
                  Зеленый цвет благодаря многообразию оттенков может найти нужный вариант даже самому искушенному покупателю.
                  Тона могут быть как холодными, так и теплыми.
                </li>
                <img
                  src="@/assets/img/articles/article-img/43.jpg"
                  alt="image"
                >
                <div>
                  <img
                    src="@/assets/img/articles/article-img/41.png"
                    alt="image"
                  >
                  <img
                    src="@/assets/img/articles/article-img/42.png"
                    alt="image"
                  >
                </div>
                <li>
                  <b>Нейтралитет.</b> Зеленый цвет отлично сочетается практически со всеми цветами радуги. В случае с кухней, это несомненный плюс.
                </li>
              </ol>
              <img
                src="@/assets/img/articles/article-img/46.jpg"
                alt="image"
              >
              <h3>Возможные сложности</h3>
              <ol>
                <li>
                  Потребность в ярких акцентах. Без наличия таковых зеленый цвет может смотреться достаточно скучно.
                </li>
                <div>
                  <img
                    src="@/assets/img/articles/article-img/47.jpg"
                    alt="image"
                  >
                  <img
                    src="@/assets/img/articles/article-img/48.jpg"
                    alt="image"
                  >
                </div>
                <li>
                  Подходит не всем стилям. Однако если грамотно продумать каждую деталь и каждый акцент в гарнитуре, есть шанс, что зеленый будет гармонично смотреться даже в классическом интерьере.
                </li>
                <img
                  src="@/assets/img/articles/article-img/49.jpg"
                  alt="image"
                >
                <li>
                  Необходимо внимательно следить за соотношением зеленых оттенков. При неправильном сочетании холодных и теплых оттенков, гарнитур может потерять целостность и будет смотреться раздроблено.
                  Проблемы можно избежать, если подойти к делу ответственно и прислушаться к советам дизайнеров.
                  Например, они говорят, что теплые тона оттенки лучше смотрятся у входа, тогда как холодные здорово впишутся в глубину гарнитура.
                </li>
                <div>
                  <img
                    src="@/assets/img/articles/article-img/54.jpg"
                    alt="image"
                  >
                  <img
                    src="@/assets/img/articles/article-img/53.jpg"
                    alt="image"
                  >
                </div>
              </ol>

              <h3>Богатая цветовая палитра</h3>
              <p>Как мы уже писали выше, зеленый цвет достаточно многогранен. Поэтому и цветовых сочетаний может быть великое множество. Рассмотрим основные:
              </p>
              <h4>Яркий зелёный</h4>
              <p>Благодаря своей насыщенности, ярко зеленая кухня будет смотреться достаточно свежо и броско. Ему в пару отлично подойдут темные или пастельные тона.
              </p>
              <img
                src="@/assets/img/articles/article-img/57.jpg"
                alt="image"
              >
              <div>
                <img
                  src="@/assets/img/articles/article-img/56.jpg"
                  alt="image"
                >
                <img
                  src="@/assets/img/articles/article-img/58.jpg"
                  alt="image"
                >
              </div>

              <h4>Тёмно-зелёный</h4>
              <p>Хорошо подходит для больших помещений. Гарнитур будет смотреться изысканно, модно и даже аристократично. Темно-зеленый оттенок самодостаточен, однако в качестве акцентов можно использовать светлые оттенки.
              </p>
              <div>
                <img
                  src="@/assets/img/articles/article-img/60.jpg"
                  alt="image"
                >
                <img
                  src="@/assets/img/articles/article-img/59.jpg"
                  alt="image"
                >
              </div>

              <h4>Изумрудный</h4>
              <p>
                Не обязательно быть волшебником, чтобы выбрать для своего гарнитура именно это цветовое решение.
                Изумрудный подходит для традиционных стилей. Он достаточно сдержан, поэтому хорошо будет смотреться в маленьких помещениях и на студиях.
              </p>
              <img
                src="@/assets/img/articles/article-img/61.jpg"
                alt="image"
              >
              <img
                src="@/assets/img/articles/article-img/62.jpg"
                alt="image"
              >

              <h4>Оливковый</h4>
              <p>Современный оттенок, который смотрится свежо и необычно. Ему не нужны дополнительный акценты и детали.</p>
              <div>
                <img
                  src="@/assets/img/articles/article-img/50.jpg"
                  alt="image"
                >
                <img
                  src="@/assets/img/articles/article-img/55.jpg"
                  alt="image"
                >
              </div>
              <p>При желании, зеленый цвет можно комбинировать с черными, желтыми, красными и бирюзовыми тонами.</p>
              <div>
                <img
                  src="@/assets/img/articles/article-img/64.jpg"
                  alt="image"
                >
                <img
                  src="@/assets/img/articles/article-img/65.jpg"
                  alt="image"
                >
              </div>
              <p>
                Что касается стилей, в которых зеленый будет смотреться гармонично, то их достаточно много — хай-тек, минимализм, лофт, классика,
                кантри и даже скандинавия.
              </p>
              <div>
                <img
                  src="@/assets/img/articles/article-img/70.jpg"
                  alt="image"
                >
                <img
                  src="@/assets/img/articles/article-img/68.jpg"
                  alt="image"
                >
              </div>
              <img
                src="@/assets/img/articles/article-img/67.jpg"
                alt="image"
              >
              <div>
                <img
                  src="@/assets/img/articles/article-img/71.jpg"
                  alt="image"
                >
                <img
                  src="@/assets/img/articles/article-img/69.jpg"
                  alt="image"
                >
              </div>
            </article>
            <div class="article__tags">
              <a
                class="article__tag"
                href="#"
              >От эксперта</a>
              <a
                class="article__tag"
                href="#"
              >Лайфхаки</a>
              <a
                class="article__tag"
                href="#"
              >Планировки</a>
            </div>
            <div class="article__stats">
              <p class="article__stats-author article__stats-el">Автор<span class="article__stats-author-name">Ксения абрамова</span></p>
              <p class="article__stats-date article__stats-el">Дата публикации<span class="article__stats-date-value">16 декабря 2020</span></p>
              <div class="article__stats-views article__stats-el">
                <img
                  class="article__stats-views-icon"
                  src="@/assets/img/articles/icons/view_simple.svg"
                  alt="image-views"
                >
                <span class="article__stats-views-count">1290</span>
              </div>
            </div>
            <div
              v-if="$_media.sm"
              class="article__share"
            >
              <p class="article__share-title">Поделиться</p>
              <div class="article__share-btns">
                <a
                  href="#"
                  class="article__share-btn"
                >
                  <AppIcon
                    name="vk"
                    class="article__share-icon"
                  />
                </a>
                <a
                  href="#"
                  class="article__share-btn"
                >
                  <AppIcon
                    name="facebook"
                    class="article__share-icon"
                  />
                </a>
                <a
                  href="#"
                  class="article__share-btn"
                >
                  <AppIcon
                    name="link"
                    class="article__share-icon"
                  />
                </a>
              </div>
            </div>
          </div>
          <div
            v-if="!$_media.sm"
            class="article__aside"
          >
            <div class="article__aside-inner">
              <ArticleAside />
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import ArticleAside from './ArticleAside.vue'
import StickySidebar from 'sticky-sidebar'
import AppIcon from './base/AppIcon.vue'

export default {
  name: 'Article',
  components: {
    ArticleAside,
    AppIcon
  },
  data() {
    return {
      scrollPage: null,
      sidebar: null
    }
  },
  mounted() {
    // START DEVELOPE CODE
    const container = document.querySelector('.article__section')
    const images = container.getElementsByTagName('img')
    const blocks = container.getElementsByTagName('div')
    images.forEach(element => {
      element.addEventListener('load', function(){ 
        if (this.naturalWidth <  this.naturalHeight) {
          element.classList.add('article__section-vertical')
        } else {
          element.classList.add('article__section-horizontal')
        }
        }); 
    });
    blocks.forEach(element => {
      const tags = element.childNodes
      for (let tag of tags) {
        if (tag.tagName === 'IMG') {
          element.classList.add('article__section-grid')
        }
      }
    });
    // END DEVELOPE CODE


    // intro-effect
    const el = this.$refs.article
    const keys = [32, 37, 38, 39, 40]

    function preventDefault(e) {
      e = e || window.event

      if (e.preventDefault) {
        e.preventDefault()
      }

      e.returnValue = false
    }

    function keydown(e) {
      for (var i = keys.length; i--; ) {
        if (e.keyCode === keys[i]) {
          preventDefault(e)
          return
        }
      }
    }

    function touchmove(e) {
      preventDefault(e)
    }

    function wheel() {}

    function disableScroll() {
      window.onmousewheel = document.onmousewheel = wheel
      document.onkeydown = keydown
      document.body.ontouchmove = touchmove
    }

    function enableScroll() {
      window.onmousewheel = document.onmousewheel = document.onkeydown = document.body.ontouchmove = null
    }

    let docElem = window.document.documentElement,
      scrollVal,
      isRevealed,
      noscroll,
      isAnimating

    function scrollY() {
      return window.pageYOffset || docElem.scrollTop
    }

    this.scrollPage = () => {
      scrollVal = scrollY()

      if (noscroll) {
        if (scrollVal < 0) {
          return false
        }

        window.scrollTo(0, 0)
      }

      if (el.classList.contains('no-transition')) {
        el.classList.remove('no-transition')
        return false
      }

      if (isAnimating) {
        return false
      }

      if (scrollVal <= 0 && isRevealed) {
        toggleReveal(0)
      } else if (scrollVal > 0 && !isRevealed) {
        toggleReveal(1)
      }
    }

    const toggleReveal = (reveal) => {
      isAnimating = true

      if (reveal) {
        el.classList.add('is-modified')
      } else {
        noscroll = true
        disableScroll()
        el.classList.remove('is-modified')
      }

      setTimeout(() => {
        isRevealed = !isRevealed
        isAnimating = false
        if (reveal) {
          noscroll = false
          enableScroll()

          // sticky-sidebar
          if (!this.$_media.sm) {
            if (this.sidebar) {
              this.sidebar.updateSticky()
            } else {
              this.sidebar = new StickySidebar('.article__aside', {
                topSpacing: this.$_media.md ? 70 : this.$_media.lg ? 130 : 170,
                bottomSpacing: 30,
                containerSelector: '.article__inner',
                innerWrapperSelector: '.article__aside-inner'
              })
            }
          }
        }
      }, 1000)
    }

    const pageScroll = scrollY()
    noscroll = pageScroll === 0

    disableScroll()

    if (pageScroll) {
      isRevealed = true
      el.classList.add('no-transition')
      el.classList.add('is-modified')

      // sticky-sidebar
      if (!this.$_media.sm) {
        setTimeout(() => {
          this.sidebar = new StickySidebar('.article__aside', {
            topSpacing: this.$_media.md ? 70 : this.$_media.lg ? 130 : 170,
            bottomSpacing: 30,
            containerSelector: '.article__inner',
            innerWrapperSelector: '.article__aside-inner'
          })
        }, 100)
      }
    }

    window.addEventListener('scroll', this.scrollPage)
    window.addEventListener('resize', this.handleResize)
  },
  unmounted() {
    if (this.sidebar) {
      this.sidebar.destroy()
    }

    window.removeEventListener('scroll', this.scrollPage)
    window.removeEventListener('resize', this.handleResize)
  },
  methods: {
    handleResize() {
      if (this.$_media.sm) {
        this.sidebar = null
      } else {

        if (this.sidebar) {
          this.sidebar.options.topSpacing = this.$_media.md ? 70 : this.$_media.lg ? 130 : 170
        } else {
          this.sidebar = new StickySidebar('.article__aside', {
            topSpacing: this.$_media.md ? 70 : this.$_media.lg ? 130 : 170,
            bottomSpacing: 30,
            containerSelector: '.article__inner',
            innerWrapperSelector: '.article__aside-inner'
          })
        }        
      }
    }
  }
}
</script>

<style lang="scss">
.article {
  $b: &;

  &:not(.no-transition) {
    #{$b} {
      &__intro,
      &__container {
        transition: opacity 1s cubic-bezier(0.7, 0, 0.3, 1), transform 1s cubic-bezier(0.7, 0, 0.3, 1);
      }
    }
  }

  &.is-modified {
    #{$b} {
      &__intro {
        opacity: 0;
        transform: translateY(-100%) scale(0.9);
      }

      &__container {
        opacity: 1;
        transform: none;
      }
    }
  }

  &__intro {
    display: flex;
    align-items: flex-end;
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    height: 100vh;
    padding: 40px 0;
    z-index: 1;

    &-picture {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;

      img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
    }

    &-title {
      position: relative;
      color: #fff;
      font-size: 26px;
      font-weight: bold;
      line-height: 1.44;
    }
  }

  &__container {
    padding-top: 40px;
    opacity: 0;
    transform: translateY(400px);
  }

  &__stats {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    max-width: 655px;
    margin-top: 5px;

    &-el {
      font-size: 13px;
      margin-bottom: 20px;
      margin-right: 10px;
    }

    &-views-icon {
      width: 20px;
      height: 20px;
    }

    &-author {
      &-name {
        font-weight: bold;
        padding-left: 10px;
        display: inline-block;
      }
    }

    &-date {
      &-value {
        font-weight: bold;
        padding-left: 10px;
        display: inline-block;
      }
    }

    &-views {
      display: flex;
      align-items: center;

      &-icon {
        display: inline-block;
      }

      &-count {
        padding-left: 10px;
        font-size: 13px;
        font-weight: bold;
        line-height: 1.538;
      }
    }
  }

  &__tags {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
  }

  &__tag {
    padding: 7px 17px;
    margin-right: 15px;
    margin-bottom: 15px;
    background-color: $color-lightviolet;
    font-size: 14px;
    color: #fff;
  }

  &__share {
    display: flex;
    align-items: center;
    color: $color-lightviolet;

    &-title {
      margin-right: 40px;
      font-weight: 500;
      font-size: 13px;
    }

    &-btns {
      display: flex;
    }

    &-btn {
      margin-right: 22px;

      &:last-child {
        margin-right: 0;
      }
    }

    &-icon {
      width: 25px;
      height: 25px;
      fill: currentColor;
    }
  }

  @include media(md) {
    &__intro {
      &-title {
        font-size: 36px;
      }
    }

    &__container {
      padding-top: 50px;
    }

    &__inner {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }

    &__stats {
      margin-top: 15px;
    }

    &__aside {
      margin-left: 50px;
      width: 290px;
      flex-shrink: 0;
    }

    &__aside-inner {
      padding-top: 28px;
    }
  }

  @include media(lg) {
    &__intro {
      &-title {
        font-size: 50px;
      }
    }

    &__container {
      padding-top: 65px;
    }

    &__aside {
      margin-left: 80px;
      width: 320px;
    }

    &__aside-inner {
      padding-top: 18px;
    }
  }

  @include media(xl) {
    &__intro-title {
      margin-left: 80px;
    }

    &__container {
      padding-top: 95px;
    }

    &__section-container {
      margin-left: 80px;
    }

    &__aside {
      margin-left: 260px;
      width: 380px;
    }
  }
}
.article__section {
  margin-bottom: 15px;
  h2 {
    font-weight: bold;
    line-height: 1.44;
    margin-bottom: 25px;
    font-size: 26px;

    @include media(md) {
      font-size: 35px;
      margin-bottom: 35px;
    }

    @include media(lg) {
      font-size: 50px;
      margin-bottom: 65px;
    }
  }

  h3 {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 20px;
    margin-top: 40px;

    @include media(md) {
      font-size: 24px;
      margin-top: 60px;
      margin-bottom: 30px;
    }

    @include media(lg) {
      margin-top: 80px;
      // margin-bottom: 50px;
    }
  }

  h4 {
    font-size: 18px;
    font-weight: bold;
    line-height: 1.889;
    margin-bottom: 20px;

    @include media(md) {
      margin-top: 50px;
      margin-bottom: 32px;
    }
    @include media(lg) {
      margin-top: 70px;
      // margin-bottom: 50px;
    }
  }

  p {
    font-size: 14px;
    line-height: 2.125;
    margin: 10px 0;

    @include media(md) {
      margin: 15px 0;
      font-size: 16px;
    }
  }

  li {
    font-size: 14px;

    @include media(md) {
      font-size: 16px;
    }
  }

  ol {
    list-style-type: none;
    counter-reset: num;
    margin: 0 0 0 38px;
    & img {
      transform: translateX(-38px);
      width: calc(100% - -38px);
    }
    & div {
      transform: translateX(-38px);
       width: calc(100% - -38px);
    }
    & li {
      position: relative;
      margin: 20px 0 30px;
      padding-left: 15px;
      line-height: 2.143;

      @include media(md) {
        padding-left: 20px;
      }

      @include media(lg) {
        padding-left: 30px;
      }

      &::before {
        content: counter(num);
        counter-increment: num;
        display: inline-block;
        position: absolute;
        top: 0;
        left: -38px;
        width: 38px;
        height: 38px;
        background: $color-lightgreen;
        padding-top: 6px;
        color: #fff;
        text-align: center;
        line-height: 28px;
        font-size: 18px;
        border-bottom-right-radius: 14px;
        border-top-left-radius: 14px;
      }
    }
  }

  div {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    align-items: baseline;
    position: relative;
    margin: 30px auto;

    // Рамка (ссылки + закругленный угол)
    & h4 {
      margin-right: auto;
      margin-bottom: 0;
      margin-top: 0;
      padding: 40px 0 20px 0;

      @include media(md) {
        margin-right: auto;
        margin-bottom: 0;
        padding: 50px 0 0 55px;
      }

      @include media(lg) {
        padding: 0;
        margin-left: auto;
      }
    }

    & h5 {
      padding-top: 20px;
      padding-bottom: 15px;
      margin-right: 40px;
      @include media(md) {
        margin-left: -40px;
        margin-left: auto;
        padding: 27px 0 27px 20px;
      }
    }

    & a {
      margin-right: auto;
    }

    & > h4 + ol {
      padding: 0;
      margin-left: 15px;
      &:last-child {
        margin-bottom: 25px;
      }
      @include media(md) {
        &:last-child {
        margin-bottom: 0;
        }
      }
      @include media(md) {
        padding: 35px 0 35px 55px;
      }

      @include media(lg) {
        padding: 55px 0 55px 55px;
      }

      margin-right: auto;

      &::before {
        content: '';
        position: absolute;
        top: 0;
        left: -9999px;
        right: 0;
        bottom: 0;
        margin: 0 auto;
        width: 10000vw;
        background-color: $color-lightgray;
        z-index: -1;

        @include media(md) {
          width: auto;
          left: 0;
          border-bottom-right-radius: 80px;
        }
      }
      & li {
        padding-bottom: 10px;
        margin: 0;
        padding-left: 0;
        color: $color-lightgreen;
        list-style-type: decimal;

        @include media(lg) {
          padding-bottom: 15px;
        }
        &::before {
          display: none;
        }

        & a {
          text-decoration: underline;
        }
      }
    }


    // Рамка (прямоугольная)
    & > h5 + a {
      font-size: 14px;
      line-height: 1.286;
      text-decoration: underline;
      color: $color-lightgreen;
      padding-bottom: 20px;

      @include media(sm) {
        max-width: 300px;
      }

      @include media(md) {
        margin-left: 0px;
        padding: 27px 0 27px 20px;
      }

      @include media(lg) {
        max-width: 520px;
      }

      &::before {
        content: '';
        position: absolute;
        top: 0;
        left: -9999px;
        right: 0;
        bottom: 0;
        margin: 0 auto;
        width: 10000vw;
        border-radius: 8px;
        background-color: $color-lightgray;
        z-index: -1;
        @include media(md) {
          width: auto;
          left: 0;
        }
      }
    }
  }
  @include media(md) {
    &__intro {
      width: auto;
      padding: 70px 0;
    }
  }
  //article__section-vertical
  &-vertical {
    width: 100%;
    height: auto;
    max-width: 550px;
    max-height: 785px;
    object-fit: cover;
    margin: 15px auto;
  }
    &-horizontal {
    width: 100%;
    height: auto;
    object-fit: cover;
    margin: 15px auto;
  }
  //article__section-grid
  &-grid {
    display: grid !important;
    grid-gap: 15px;
    margin: 15px auto !important;
    grid-template-columns: 1fr;
    grid-template-rows: minmax(min-content , auto) minmax(min-content, auto);

    @include media(xs) {
      grid-template-columns: minmax(min-content , auto) minmax(min-content, auto);
      grid-template-rows: 1fr;
    }
    & img {
      width: 100% !important;
      height: 100%;
      transform: translateX(0) !important;
      margin: 0;
      max-width: none;
      max-height: 550px;
    }
  }
}
</style>
